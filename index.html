<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Agenda de Eventos 2026</title>
    <style>
        :root {
            --primary: #1a1a1a; --accent: #4a90e2; --green: #28a745;
            --yellow: #ffc107; --red: #dc3545; --bg: #f0f2f5; --card: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, system-ui, sans-serif; background-color: var(--bg); color: var(--primary); padding-bottom: 80px; }

        .app-container { max-width: 480px; margin: 0 auto; min-height: 100vh; display: flex; flex-direction: column; }

        header { background: var(--primary); color: white; padding: 15px; position: sticky; top: 0; z-index: 10; }
        
        .backup-bar { 
            display: flex; justify-content: space-around; padding: 10px 0; 
            border-bottom: 1px solid #333; margin-bottom: 10px; font-size: 0.75rem;
        }
        .btn-backup { background: #333; color: #ccc; border: 1px solid #444; padding: 5px 10px; border-radius: 4px; cursor: pointer; }

        .month-nav { display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.1); border-radius: 25px; padding: 5px; }
        .nav-btn { background: none; border: none; color: white; font-size: 1.2rem; padding: 5px 15px; }

        .calendar-section { background: var(--card); margin: 10px; border-radius: 15px; padding: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .weekdays { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; font-weight: bold; font-size: 0.7rem; color: #888; margin-bottom: 10px; }
        .days-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px; }
        .day { aspect-ratio: 1/1; display: flex; align-items: center; justify-content: center; font-size: 0.9rem; border-radius: 8px; position: relative; cursor: pointer; }
        .day.today { color: var(--accent); font-weight: bold; border: 1px solid var(--accent); }
        .day.selected { background: var(--accent) !important; color: white !important; }
        .day.has-event::after { content: ''; width: 6px; height: 6px; background: var(--red); border-radius: 50%; position: absolute; bottom: 4px; }

        .day-details { padding: 15px; flex-grow: 1; }
        .event-card { background: var(--card); border-radius: 12px; padding: 15px; margin-bottom: 10px; border-left: 6px solid var(--accent); animation: slideUp 0.3s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .fab { position: fixed; bottom: 90px; right: 20px; background: var(--green); color: white; width: 60px; height: 60px; border-radius: 30px; display: flex; align-items: center; justify-content: center; font-size: 30px; box-shadow: 0 4px 12px rgba(40,167,69,0.4); border: none; z-index: 5; }

        footer {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: var(--primary); color: #888;
            text-align: center; padding: 15px; font-size: 0.8rem;
            border-top: 1px solid #333; z-index: 10;
        }
        .signature { color: white; font-weight: bold; letter-spacing: 1px; }

        /* Modal customizado */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 100; align-items: flex-end; }
        .modal { background: white; width: 100%; border-radius: 20px 20px 0 0; padding: 25px; animation: slideIn 0.3s ease-out; max-height: 90vh; overflow-y: auto; }
        @keyframes slideIn { from { transform: translateY(100%); } to { transform: translateY(0); } }
        
        label { display: block; font-size: 0.8rem; font-weight: bold; margin-bottom: 5px; color: #666; }
        input, select { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; }
        
        .color-grid { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
        .color-option { width: 35px; height: 35px; border-radius: 50%; border: 3px solid transparent; cursor: pointer; }
        .color-option.active { border-color: #333; }

        .modal-actions { display: flex; gap: 10px; margin-top: 10px; }
        .btn { flex: 1; padding: 15px; border: none; border-radius: 8px; font-weight: bold; font-size: 0.9rem; }
        .btn-save { background: var(--green); color: white; }
        .btn-delete { background: var(--red); color: white; }
    </style>
</head>
<body>

<div class="app-container">
    <header>
        <div class="backup-bar">
            <button class="btn-backup" onclick="exportBackup()">üì§ BACKUP</button>
            <button class="btn-backup" onclick="document.getElementById('importFile').click()">üì• RESTAURAR</button>
            <input type="file" id="importFile" style="display:none" onchange="importBackup(event)">
        </div>
        <div class="month-nav">
            <button class="nav-btn" onclick="changeMonth(-1)">‚ùÆ</button>
            <span id="monthLabel">JANEIRO 2026</span>
            <button class="nav-btn" onclick="changeMonth(1)">‚ùØ</button>
        </div>
    </header>

    <div class="calendar-section">
        <div class="weekdays">
            <div>DOM</div><div>SEG</div><div>TER</div><div>QUA</div><div>QUI</div><div>SEX</div><div>S√ÅB</div>
        </div>
        <div id="daysGrid" class="days-grid"></div>
    </div>

    <div class="day-details" id="dayDetails">
        <p style="text-align: center; color: #999; margin-top: 20px;">Selecione um dia no calend√°rio</p>
    </div>

    <button class="fab" onclick="openModal()">+</button>

    <footer>
        Agenda de Eventos - Calend√°rio 2026 [cite: 12, 67, 137]<br>
        <span class="signature">By: An.Yoshi</span>
    </footer>
</div>

<div class="modal-overlay" id="modalOverlay">
    <div class="modal">
        <h3 id="modalTitle" style="margin-bottom:20px; text-align:center">Agendar Evento</h3>
        
        <label>DESCRI√á√ÉO DO EVENTO</label>
        <input type="text" id="eventDesc" placeholder="Ex: Reuni√£o de Equipe [cite: 32]">
        
        <label>HOR√ÅRIO</label>
        <input type="time" id="eventTime">
        
        <label>ENDERE√áO / LOCAL</label>
        <input type="text" id="eventLoc" placeholder="Ex: Escrit√≥rio Central ou Link Zoom">
        
        <label>CATEGORIA PERSONALIZADA</label>
        <input type="text" id="eventCat" placeholder="Ex: Importante, Educativo, Dica... [cite: 41, 5, 20]">

        <label>ESCOLHA A COR DE DESTAQUE</label>
        <div class="color-grid" id="colorPicker">
            <div class="color-option active" style="background: #28a745" data-color="#28a745"></div>
            <div class="color-option" style="background: #ffc107" data-color="#ffc107"></div>
            <div class="color-option" style="background: #dc3545" data-color="#dc3545"></div>
            <div class="color-option" style="background: #4a90e2" data-color="#4a90e2"></div>
            <div class="color-option" style="background: #9c27b0" data-color="#9c27b0"></div>
            <div class="color-option" style="background: #e91e63" data-color="#e91e63"></div>
            <div class="color-option" style="background: #1a1a1a" data-color="#1a1a1a"></div>
        </div>

        <div class="modal-actions">
            <button class="btn btn-save" onclick="saveEvent()">SALVAR</button>
            <button class="btn btn-delete" id="delBtn" onclick="deleteEvent()" style="display:none">EXCLUIR</button>
            <button class="btn" onclick="closeModal()" style="background:#eee">VOLTAR</button>
        </div>
    </div>
</div>

<script>
    let current = new Date();
    const STORAGE_KEY = 'yoshi_event_agenda_2026';
    let events = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
    let selectedDateKey = null;
    let selectedColor = "#28a745";

    const monthNames = ["JANEIRO", "FEVEREIRO", "MAR√áO", "ABRIL", "MAIO", "JUNHO", "JULHO", "AGOSTO", "SETEMBRO", "OUTUBRO", "NOVEMBRO", "DEZEMBRO"];

    // Configura√ß√£o do seletor de cores
    document.querySelectorAll('.color-option').forEach(opt => {
        opt.onclick = () => {
            document.querySelectorAll('.color-option').forEach(o => o.classList.remove('active'));
            opt.classList.add('active');
            selectedColor = opt.dataset.color;
        };
    });

    function initCalendar() {
        const year = current.getFullYear();
        const month = current.getMonth();
        document.getElementById('monthLabel').innerText = `${monthNames[month]} ${year}`;
        const firstDay = new Date(year, month, 1).getDay();
        const lastDay = new Date(year, month + 1, 0).getDate();
        const grid = document.getElementById('daysGrid');
        grid.innerHTML = '';

        for(let i=0; i<firstDay; i++) grid.innerHTML += `<div class="day"></div>`;

        for(let d=1; d<=lastDay; d++) {
            const key = `${year}-${month+1}-${d}`;
            const isToday = new Date().toDateString() === new Date(year, month, d).toDateString();
            const hasEvent = events[key] ? 'has-event' : '';
            grid.innerHTML += `<div class="day ${isToday ? 'today' : ''} ${hasEvent}" id="day-${key}" onclick="selectDay('${key}')">${d}</div>`;
        }
    }

    function selectDay(key) {
        selectedDateKey = key;
        document.querySelectorAll('.day').forEach(d => d.classList.remove('selected'));
        const el = document.getElementById(`day-${key}`);
        if(el) el.classList.add('selected');

        const details = document.getElementById('dayDetails');
        const ev = events[key];
        if(ev) {
            details.innerHTML = `
                <div class="event-card" style="border-left-color: ${ev.color}" onclick="openModal(true)">
                    <p style="font-size:0.7rem; color:${ev.color}; font-weight:bold; text-transform:uppercase">${ev.cat}</p>
                    <strong style="font-size:1.1rem">${ev.time} - ${ev.desc}</strong><br>
                    <small style="color:#666">üìç ${ev.loc}</small>
                </div>`;
        } else {
            details.innerHTML = `<button class="btn" style="width:100%; border: 2px dashed #ccc; color:#888; background:none" onclick="openModal()">+ Agendar Novo Evento</button>`;
        }
    }

    function exportBackup() {
        const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(events));
        const downloadAnchorNode = document.createElement('a');
        downloadAnchorNode.setAttribute("href", dataStr);
        downloadAnchorNode.setAttribute("download", "agenda_2026_yoshi.json");
        document.body.appendChild(downloadAnchorNode);
        downloadAnchorNode.click();
        downloadAnchorNode.remove();
    }

    function importBackup(event) {
        const file = event.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                events = JSON.parse(e.target.result);
                localStorage.setItem(STORAGE_KEY, JSON.stringify(events));
                initCalendar();
                alert("Agenda restaurada!");
            } catch (err) { alert("Arquivo inv√°lido."); }
        };
        reader.readAsText(file);
    }

    function openModal(isEdit = false) {
        if(!selectedDateKey) return;
        document.getElementById('modalOverlay').style.display = 'flex';
        const ev = events[selectedDateKey];
        if(isEdit && ev) {
            document.getElementById('modalTitle').innerText = "Editar Evento";
            document.getElementById('eventDesc').value = ev.desc;
            document.getElementById('eventTime').value = ev.time;
            document.getElementById('eventLoc').value = ev.loc;
            document.getElementById('eventCat').value = ev.cat;
            selectedColor = ev.color;
            document.getElementById('delBtn').style.display = 'block';
        } else {
            document.getElementById('modalTitle').innerText = "Agendar Evento";
            document.getElementById('eventDesc').value = "";
            document.getElementById('eventTime').value = "08:00";
            document.getElementById('eventLoc').value = "";
            document.getElementById('eventCat').value = "";
            document.getElementById('delBtn').style.display = 'none';
        }
    }

    function saveEvent() {
        const desc = document.getElementById('eventDesc').value;
        if(!desc) return alert("Descreva o evento!");
        
        events[selectedDateKey] = {
            desc: desc,
            time: document.getElementById('eventTime').value,
            loc: document.getElementById('eventLoc').value || "Local n√£o informado",
            cat: document.getElementById('eventCat').value || "Geral",
            color: selectedColor
        };
        localStorage.setItem(STORAGE_KEY, JSON.stringify(events));
        closeModal(); initCalendar(); selectDay(selectedDateKey);
    }

    function deleteEvent() {
        if(confirm("Excluir este evento?")) {
            delete events[selectedDateKey];
            localStorage.setItem(STORAGE_KEY, JSON.stringify(events));
            closeModal(); initCalendar();
            document.getElementById('dayDetails').innerHTML = `<p style="text-align: center; color: #999;">Evento removido.</p>`;
        }
    }

    function closeModal() { document.getElementById('modalOverlay').style.display = 'none'; }
    function changeMonth(dir) { current.setMonth(current.getMonth() + dir); initCalendar(); }

    initCalendar();
</script>
</body>
</html>
